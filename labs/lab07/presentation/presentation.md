---
## Front matter
lang: ru-RU
title: Управление журналами событий в системе
subtitle: Часть 1
author:
  - Славинский В.В.
institute:
  - Российский университет дружбы народов, Москва, Россия Россия
date: 18 октября 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Славинский Владислав Вадимович
  * Студент
  * Российский университет дружбы народов
  * [1132246169@pfur.ru]

:::
::: {.column width="30%"}

# Вводная часть

## Переход в режим суперпользователя

Запустим три вкладки терминала и в каждом из них получим полномочия администратора

![sc1](./image/1.png)

## Запуск мониторинга системных событий в реальном времени

На второй вкладке терминала запустим мониторинг системных событий в реальном времени: tail -f /var/log/messages.

![sc2](./image/2.png)

## Ввод неверого пароля

В третьей вкладке терминала вернемся к учётной записи своего пользователя. Попробуем войти в режим суперпользователя, но при этом введем неправильный пароль и посмотрим вторую вкладку терминала.

![sc3](./image/3.png)

## Logger hello

В третьей вкладке терминала из оболочки пользователя введем logger hello.

![sc4](./image/4.png)

## Запуск мониторига сообщений безопасности

Во второй вкладке терминала с мониторингом остановите трассировку файла сообщений мониторинга реального времени, используя ctrl+c. Затем запустим мониторинг сообщений безопасности (последние 20 строк соответствующего файла логов): tail -n 20 /var/log/secure.

![sc5](./image/5.png)

## Установка Apache

В первой вкладке терминала установим Apache: dnf -y install httpd.

![sc6](./image/6.png)

## Запуск веб-службы

После окончания процесса установки запустим веб-службу: systemctl start httpd, systemctl enable httpd.

![sc7](./image/7.png)

## Просмотр журнала с сообщениями об ошибках веб службы

Во второй вкладке терминала посмотрим журнал сообщений об ошибках веб-службы: tail -f /var/log/httpd/error_log.

![sc8](./image/8.png)

## Добавление строки в файле конфигурации

В третьей вкладке терминала получим полномочия администратора и в файле конфигурации /etc/httpd/conf/httpd.conf в конце добавим следующую строку: ErrorLog syslog:local1.

![sc9](./image/9.png)

## Создание файла мониторига событий веб-службы

В каталоге /etc/rsyslog.d создадим файл мониторинга событий веб-службы:cd /etc/rsyslog.d, touch httpd.conf. Потом пропишем в нем local1.* -/var/log/httpd-error.log. Эта строка позволит отправлять все сообщения, получаемые для объекта local1 в файл /var/log/httpd-error.log.

![sc10](./image/10.png)

## Перезагрузка конфигурации rsyslogd и веб-службы

Перейдем в первую вкладку терминала и перезагрузите конфигурацию rsyslogd и веб-службу:systemctl restart rsyslog.service, systemctl restart httpd.

![sc11](./image/11.png)

## Создание отдельного файла конфигурации для мониторинга отладочной информации

В третьей вкладке терминала создадим отдельный файл конфигурации для мониторинга отладочной информации: cd /etc/rsyslog.d, touch debug.conf. И в этом же терминале введем echo "*.debug /var/log/messages-debug" > /etc/rsyslog.d/debug.conf.

![sc12](./image/12.png)

## Перезапуск rsyslog

В первой вкладке терминала снова перезапустим rsyslogd: systemctl restart rsyslog.service.

![sc13](./image/13.png)

## Запуск мониторинга отладочной информации


Во второй вкладке терминала запустим мониторинг отладочной информации: tail -f /var/log/messages-debug.

![sc14](./image/14.png)

## Ввод команды

В третьей вкладке терминала введем: logger -p daemon.debug "Daemon Debug Message".

![sc15](./image/15.png)

## Содержимое журнала с событиями с момента последнего запуска системы

Во второй вкладке терминала посмотрим содержимое журнала с событиями с момента последнего запуска системы: journalctl.

![sc16](./image/16.png)

## Просмотр журнала без использования пейджера

Просмотр содержимого журнала без использования пейджера: journalctl --no-pager.

![sc17](./image/17.png)

## Просмотр журнала в режиме реального времени

Режим просмотра журнала в реальном времени: journalctl -f.

![sc18](./image/18.png)

## Использование фильтрации просмотра конкретных параметров журнала

Для использования фильтрации просмотра конкретных параметров журнала введем journalctl и дважды нажмем клавишу tab.

![sc19](./image/19.png)

## Просмотр сыбтия для uid 0

Просмотрим события для UID0: journalctl _UID=0.

![sc20](./image/20.png)

## Отображение последних 20 строк журнала

Для отображения последних 20 строк журнала введем: journalctl -n 20.

![sc21](./image/21.png)

## Просмотр только сообщений об ошибках

Для просмотра только сообщений об ошибках введем: journalctl -p err.

![sc22](./image/22.png)

## Просмотр сообщений за определенный период времени

Если мы хотим просмотреть сообщения журнала, записанные за определённый период времени, мы можем  использовать параметры --since и --until. Введем например команду, для просмотра всех сообщений со вчерашнего дня через --since: journalctl --since yesterday.

![sc23](./image/23.png)

## Все сообщения с ошибкой приоритета

Если мы хотим показать все сообщения с ошибкой приоритета, которые были зафиксированы со вчерашнего дня, то мы используем: journalctl --since yesterday -p err.

![sc24](./image/24.png)

## Вывод детальной информации

Если нам нужна детальная информация, то будем использовать journalctl -o verbose.

![sc25](./image/25.png)

## Дополнительная информация о модуле sshd

Для просмотра дополнительной информации о модуле sshd введем: journalctl _SYSTEMD_UNIT=sshd.service.

![sc26](./image/26.png)

## Создание каталога для хранения записей журнала

Запустим терминал и получим полномочия администратора. Затем создадим каталог для хранения записей журнала: mkdir -p /var/log/journal.

![sc27](./image/27.png)

## Корректировка прав доступа

Скорректируем права доступа для каталога /var/log/journal, чтобы journald смог записывать в него информацию:chown root: systemd-journal /var/log/journal, chmod 2755 /var/log/journal.

![sc28](./image/28.png)

## Принятие изменений

Для принятия изменений нам необходимо или перезагрузить систему (перезапустить службу systemd-journald недостаточно), или использовать команду: killall -USR1 systemd-journald.

![sc29](./image/29.png)

## Включение вывода сообщений после перезагрузки

Журнал systemd теперь постоянный. Если мы хотим видеть сообщения журнала с момента последней перезагрузки, то используем: journalctl -b.

![sc30](./image/30.png)


